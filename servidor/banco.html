<!DOCTYPE html>
<html lang="pt-BR">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="icon" href="../img/icon.png" type="x-icon">
        <title> Controle Letícia | Inicio </title>

		<style scoped>

            @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;600&family=Ubuntu:wght@400;500;700&display=swap');

			:root {
				/* Cores do aplicativo */
				--one: #002242;
				--two: #144774;
				--tree: #336FA5;
				--four: #4E8BB8;
				--five: #6FADD2;
		                --six: #9ECAE3;
		                --gray: #b3abab;
		                --white: white;
		                --font: 'Ubuntu', sans-serif;
			 	--green: rgb(20, 218, 20);
				--red: rgb(240, 36, 36);
			}

			*  {
				padding: 0px;
				margin: 0px;
				box-sizing: border-box;
				font-family: var(--font);
			}

			*::-webkit-scrollbar {
			    display: none; /* Oculta a barra de rolagem padrão no Chrome e Safari */
			}

			body {
				background: var(--two);
				color: var(--white);
				user-select: none;
				font-family: 'Arial', sans-serif;
				overflow-x: hidden;
		                width: auto;
				height: auto;
			}

            /* ALERTA MODIFICADO */
            .swal-modal {
                background-color: var(--one);
                border: 3px solid white;
                border-radius: 10px;
            }

            .swal-title {
                width: 100%;
                height: 100%;
                font-size: 22px;
                color: var(--white);
                border-bottom: 2px solid var(--white);
                padding: 0px 0px 20px 0px;
                letter-spacing: 0.5px;
            }

            .swal-text {
                color: var(--white);
                margin: 20px 0px 0px 0px;
                font-size: 20px;
                letter-spacing: 0.5px;
                text-align: center;
            }

            .swal-button {
                background-color: var(--white);
                color: var(--one);
            } .swal-button--confirm {
                background-color: var(--white);
                color: var(--one);
            } .swal-button--cancel {
                background-color: var(--red);
                color: white;
            }

            /* NAVGATION */

            .navgation {
                width: 100vw;
                height: 100px;
                display: flex;
                background: var(--one);
                padding: 0px 10px;
            }

            .navgation img {
                width: 200px;
                height: 200px;
                margin: -50px 0px 0px 0px;
                cursor: pointer;
            }

            .navgation .perfil {
                width: auto;
                height: 100%;
                padding: 0px 5px;
                display: flex;
                align-items: center;
                margin: 0px 15px 0px auto;
                cursor: pointer;
            }

            .navgation .perfil ion-icon {
                font-size: 45px;
                margin: 0px 9px 0px 0px;
            } .navgation .perfil:hover {
                color: var(--six);
                transition: all .3s ease-in-out;
            }

            .menuPerfil {
                width: auto;
                height: auto;
                position: absolute;
                top: 100px;
                right: 4px;
                padding: 10px;
                display: none;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                background: var(--two);
                color: var(--white);
                border: 2px solid var(--white);
                cursor: pointer;
                z-index: 800;
            }

            .menuPerfil .column {
                display: flex;
                flex-direction: row;
                align-items: center;
                margin: 10px 0px 0px 0px;
            }

            .menuPerfil .column ion-icon {
                font-size: 35px;
                margin: 0px 5px 0px 5px;
            }

            .menuPerfil p {
                font-size: 20px;
                font-weight: 500;
            }

            @media (max-width: 670px) {
                .perfil h1 {
                    display: none;
                }
            }

            /* MENU LATERAL */

            .menu-lateral {
                width: 65px;
                height: auto;
                background: var(--one);
            }

            .menu-lateral ul {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
            }

            .menu-lateral ul li {
                width: 100%;
                height: auto;
                list-style: none;
                padding: 15px;
                cursor: pointer;
                color: var(--white);
                display: flex;
                flex-direction: row;
                justify-content: center;
                align-items: center;
            } .menu-lateral ul li:hover {
                color: var(--tree);
                transition: all .1s linear;
            }

            .menu-lateral ul li ion-icon {
                font-size: 30px;
            }

            .menu-lateral ul li div p {
                font-size: 18px;
                font-weight: 500;
                letter-spacing: 0.2px;
                margin: 0px 0px 0px 8px;
                
            }

            .menu-lateral ul li.selecionado {
                border-left: 4px solid var(--tree);
                color: var(--tree);
            }

            .none {
                display: none;
            }

            /* CONTAINER */
            .container {
                width: 100vw;
                height: auto;
                min-height: 100vh;
                display: flex;
                flex-direction: row;
            }

            .content {
                width: 100%;
                max-width: 100%;
                height: max-content;
                display: flex;
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                margin: 15px 0px;
            }

            .content article {
                width: 46%;
                height: auto;
                min-height: max-content;
                background: var(--white);
                color: var(--one);
                margin: 10px;
                display: flex;
                flex-direction: column;
                box-shadow: 0px 0px 10px var(--one);
                padding: 30px 20px 5px 20px;
                border-radius: 12px;
            }

            @media (max-width: 782px) {
                .content article {
                    width: 85%;
                }
            }

            .content article .titulo {
                width: 100%;
                height: auto;
                border-radius: 0px 0px 10px 10px;
                background: var(--white);
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
                position: relative;
            }

            .content article .titulo .detalhe {
                width: 100.6%;
                height: 15px;
                background: var(--one);
                position: absolute;
                top: -15px;
                border-radius: 10px 10px 0px 0px;
            }

            .content article .titulo h1 {
                width: 100%;
                color: var(--one);
                font-size: 17px;
                font-weight: 600;
                letter-spacing: 0px;
                margin: 12px 0px 15px 0px;
            }

            .content article .gerenciador {
                width: 100%;
                height: auto;
                display: flex;
                flex-direction: column;
                align-items: center;
                margin: 20px 0px;
                padding: 0px;
            }
            

            .content article .gerenciador .pergunta {
                width: 100%;
                height: auto;
                background: var(--white);
                display: flex;
                flex-direction: column;
                position: relative;
                padding: 12px 20px;
                border-radius: 10px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
            }

            .content article .gerenciador .pergunta h1 {
                width: 100%;
                color: var(--one);
                font-size: 16px;
                font-weight: 600;
                letter-spacing: 0.3px;
                margin: 8px 0px 4px 0px;
            }

            .content article .gerenciador .pergunta  button {
                width: max-content;
                height: max-content;
                background: var(--one);
                color: var(--white);
                border-radius: 8px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                letter-spacing: 0.5px;
                margin: 10px 0px;
                padding: 10px;
            } .content article .gerenciador button:hover {
                background: transparent;
                color: var(--one);
                transition: all .2s ease-in-out;
            }

            .formulario {
                width: 100%;
                max-width: 500px;
                height: auto;
                display: none;
                flex-direction: column;
                padding: 0px 20px;
                position: relative;
                padding: 10px 20px;
                color: var(--one);
                box-shadow: 0px 0px 1px var(--one);
                border-radius: 10px;
                border: 1px solid var(--one);
                margin: 20px 0px;
            }

            .formulario h1 {
                width: 100%;
                color: var(--one);
                font-size: 20px;
                font-weight: 600;
                letter-spacing: 0.3px;
                margin: 5px 0px 18px 0px;
            }

            .formulario label {
                font-size: 15.5px;
                font-weight: 600;
                letter-spacing: 0.5px;
                margin: 0px 0px 0px 0px;
                text-transform: uppercase;
                display: flex;
                align-items: center;
            }

            .formulario label span {
                margin: 0px 0px 0px 5px;
                font-size: 17.5px;
            }

            .formulario input {
                width: 95%;
                height: 40px;
                background: transparent;
                color: var(--one);
                border-radius: 4px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
                outline: none;
                font-size: 15px;
                font-weight: 600;
                letter-spacing: 0.5px;
                margin: 5px 0px 15px 0px;
                padding: 6px 12px;
            } .formulario input:focus {
                background: transparent;
                transition: all .2s ease-in-out;
            }

            .formulario select {
                width: 95%;
                height: 40px;
                background: transparent;
                color: var(--one);
                border-radius: 4px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
                outline: none;
                font-size: 15px;
                font-weight: 600;
                letter-spacing: 0.5px;
                margin: 5px 0px 15px 0px;
                padding: 6px 12px;
                cursor: pointer;
            }

            .formulario button {
                width: max-content;
                height: max-content;
                background: var(--one);
                color: var(--white);
                cursor: pointer;
                font-size: 15px;
                font-weight: 500;
                letter-spacing: 0.5px;
                margin: 5px 0px;
                border-radius: 4px;
                padding: 10px 15px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
            } .formulario button:hover {
                background: transparent;
                color: var(--one);
                transition: all .3s ease-in-out;
            }

            .verAvisoSite, .lista {
                width: 100%;
                height: auto;
                display: none;
                flex-direction: column-reverse;
                align-items: center;
                border-radius: 10px;
                color: var(--one);
                margin: 20px 0px 20px 0px;
                padding: 10px 0px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
            }

            .series, .form {
                flex-direction: column;
            }

            .verAvisoSite li, .lista li {
                width: 90%;
                height: auto;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding: 10px;
                margin: 12px 0px;
                border: 1.5px solid var(--one);
                box-shadow: 0px 0px 5px var(--one);
                border-radius: 10px;
            }
			
		.lista li .flex {
			width: 100%;
			height: auto;
			display: flex;
			flex-direction: row;
			align-items: center;
			margin: 5px 0px;
		}

		.lista li button.verde {
			background: var(--green);
			border: 2px solid var(--green);
		} .lista li button.verde:hover {
			background: transparent;
			color: var(--green);
		}

		.lista li button.vermelho {
			background: var(--red);
			border: 2px solid var(--red);
		} .lista li button.vermelho:hover {
			background: transparent;
			color: var(--red);
		}

            .verAvisoSite h1, .lista h1 {
                font-size: 16px;
                font-weight: 600;
                letter-spacing: 0.3px;
                margin: 0px 0px 0px 5px;
                text-shadow: 0px 0px 5px var(--white);
                display: flex;
                flex-direction: row;
                align-items: center;
            }

            .verAvisoSite ion-icon, .lista ion-icon {
                font-size: 25px;
                padding: 3px;
                border-radius: 8px;
                margin: 0px 10px 0px auto;
                background: var(--red);
                color: white;
                cursor: pointer;
                border: 2px solid var(--red);
            } .verAvisoSite ion-icon:hover, .lista ion-icon:hover {
                background: transparent;
                color: var(--red);
                transition: all .3s ease-in-out;
            } 

            .lista ion-icon.iconNormal {
                background: transparent;
                color: var(--one);
                border: none;
                width: 25px;
                height: 25px;
                font-size: 25px;
                padding: 0px;
                border-radius: 0px;
                margin: 0px 10px 0px 0px;
            }

            .verAvisoSite button, .lista button {
                width: max-content;
                height: max-content;
                background: var(--one);
                color: var(--white);
                cursor: pointer;
                font-size: 15px;
                font-weight: 500;
                letter-spacing: 0.5px;
                margin: 5px 0px;
                border-radius: 4px;
                padding: 10px 15px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
            } .verAvisoSite button:hover, .lista button:hover {
                background: transparent;
                color: var(--one);
                transition: all .3s ease-in-out;
            }

            /* BTN PLATAFORMAS */

            .btn-plataformas {
                width: max-content;
                height: max-content;
                background: var(--one);
                color: var(--white);
                cursor: pointer;
                font-size: 14.5px;
                font-weight: 500;
                letter-spacing: 0.5px;
                margin: 20px 0px 0px 5px;
                border-radius: 7px;
                padding: 10px 15px;
                border: 1px solid var(--one);
                box-shadow: 0px 0px 1px var(--one);
                align-self: flex-start;
            }

            </style>

           </head>

           <body>

                <nav class="navgation">

                    <img src="../img/logo.png" alt="LOGO">
                    
                    <perfil onclick="menuPerfil()" class="perfil">
                        <ion-icon name="person-circle"></ion-icon>
                        <h1 class="nome"></h1>
                    
                        <div onclick="sairDaConta()" class="menuPerfil">

                            <div>
                                <h2 class="nome"></h2>
                            </div>
                            
                            <div class="column">
                                <ion-icon name="log-out"></ion-icon>
                                <p>Sair da Conta</p>
                            </div>
    
                        </div>
                    
                    </perfil>


                </nav>

                
                <main class="container">

                    <article class="menu-lateral">

                        <ul>
    
                             <!-- HOME -->
                             <li onclick="irPagina('index')" class="selecionado">
                                <ion-icon name="home"></ion-icon>
                                <div class="none">
                                    <p>Página Inicial</p>
                                </div>
                            </li>
    
                            <!-- CHAT -->
                            <li onclick="irPagina('conversas')">
                                <ion-icon name="chatbubbles-outline"></ion-icon>
                                <div class="none">
                                    <p>Conversas</p>
                                </div>
                            </li>
    
                            <!-- FORMULARIOS -->
                            <li onclick="irPagina('formularios')">
                                <span class="material-symbols-outlined">assignment</span>
                                <div class="none">
                                    <p>Formulários</p>
                                </div>
                            </li>
    
                            <!-- ESTATISTICAS -->
                            <li onclick="irPagina('estatisticas')">
                                <ion-icon name="stats-chart-outline"></ion-icon>
                                <div class="none">
                                    <p>Estatísticas</p>
                                </div>
                            </li>
                            
    
                        </ul>
    
                    </article>

                  <!-- CONTENT -->
                  <section class="content">
                  
                    <article class="banco-de-dados">
                        
                        <div class="titulo">
                            <div class="detalhe"></div>
                            <h1>Gerenciador do Banco de Dados</h1>
                        </div>
                        
                        <!-- Adicionar Serie -->
                        <section class="formulario addSerie">

                            <h1>Adicionar Serie</h1>
        
                            <label>Serie</label>
                            <input id="serie" placeholder="ex: 9anoA" type="text">
        
                            <button onclick="addSerie()">Enviar</button>
        
                        </section>

                        <!-- Ler Series -->
                        <section class="lista series">

                        </section>

                        <!-- Adicionar Usuario Direção -->
                        <section class="formulario adddirecao">

                            <h1>Adicionar Usuario a Direção</h1>
        
                            <label>Nome</label>
                            <input id="direcao" placeholder="ex: Fabio" type="text">
        
                            <button onclick="addUsuario('direcao')">Enviar</button>
        
                        </section>

                        <!-- Ler Usuarios da Direcao -->
                        <section class="lista usuariosdirecao">

                        </section>
                        
                        <!-- Adicionar Usuario Coordenacao -->
                        <section class="formulario addcoordenacao">

                            <h1>Adicionar Usuario a Coordenação</h1>
        
                            <label>Nome</label>
                            <input id="coordenacao" placeholder="ex: Fabio" type="text">
        
                            <button onclick="addUsuario('coordenacao')">Enviar</button>
        
                        </section>

                        <!-- Ler Usuarios da Direcao -->
                        <section class="lista usuarioscoordenacao">

                        </section>

                        <!-- Adicionar Usuario Professor -->
                        <section class="formulario addprofessor">

                            <h1>Adicionar Professores</h1>
        
                            <label>Nome</label>
                            <input id="professor" placeholder="ex: Fabio" type="text">
        
                            <button onclick="addUsuario('professor')">Enviar</button>
        
                        </section>

                        <!-- Ler Usuarios da Direcao -->
                        <section class="lista usuariosprofessor">

                        </section>

                        <!-- Adicionar Formulario -->
                        <section class="formulario addForm">

                            <h1>Adicionar Formulário</h1>
        
                            <label>Nome</label>
                            <input id="nomeForm" placeholder="ex: Controle" type="text">
        
                            <label>Icon <span id="mostrarIcone"></span></label>
                            <select onchange="atualizarIcone()" id="iconForm">
                                <!-- Icones -->
                            </select>
                            <!--<input id="iconForm" placeholder="ex: document" type="text">
                            -->

                            <label>Url do Formulário</label>
                            <input id="formularioForm" placeholder="ex: https://docs.google.com/forms/" type="text">
        
                            <label>Url da Planilha</label>
                            <input id="planilhaForm" placeholder="ex: https://docs.google.com/forms/" type="text">
        
                            <button onclick="addForm()">Enviar</button>
        
                        </section>

                        <!-- Ler Formularios -->
                        <section class="lista form">
			
                        </section>

                        <!-- GERENCIADOR -->
                        <div class="gerenciador">

                            <div class="pergunta">
                                
                                <h1>Gerenciar Series</h1>
                                <button onclick="lerSeries(), abrirForm('series', 'banco-de-dados')">Series</button>

                                <h1>Gerenciar Usuarios</h1>
                                <button onclick="lerUsuarios('direcao'), abrirForm('usuariosdirecao', 'banco-de-dados')">Direção</button>
                                <button onclick="lerUsuarios('coordenacao'), abrirForm('usuarioscoordenacao', 'banco-de-dados')">Coordenação</button>
                                <button onclick="lerUsuarios('professor'), abrirForm('usuariosprofessor', 'banco-de-dados')">Professores</button>
                                
                                <!--<h1>Gerenciar Senha</h1>
                                <button onclick="mudarSenha('direcao'), abrirForm('senhadirecao', 'banco-de-dados')">Mudar Senha da Direção</button>
                                <button onclick="mudarSenha('coordenacao'), abrirForm('senhacoordenacao', 'banco-de-dados')">Mudar Senha da Coordenação</button>
                                <button onclick="mudarSenha('professor'), abrirForm('senhaprofessor', 'banco-de-dados')">Mudar Senha dos Professores</button>
                                -->

                                <h1>Gerenciar Formulários</h1>
                                <button onclick="lerForm(), abrirForm('form', 'banco-de-dados')">Ver Formulários</button>

                            </div>

                            <button onclick="bancodedados()" class="btn-plataformas">Abrir Banco de Dados</button>

                        </div>

                    </article>
                
                  </section>

                </main>


                <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
            </body>

       <!-- JavaScript -->
       <script>

        function aplicativo() {
            window.open('https://app-leticia.netlify.app/');
        }

        function website() {
            window.open('https://escola-leticia.netlify.app/');
        }

        function bancodedados() {
            window.open('https://console.firebase.google.com/');
        }

        // IR PARA A PAGINA
        function irPagina(pagina) {
            window.location.href = `./${pagina}.html`;
        }

        // ABRIR FORMULARIO COM A CLASSE
        function abrirForm(classe, gerenciador) {
            const gerenciado = document.querySelector(`.${gerenciador} .gerenciador`);
            const forms = document.querySelectorAll(`.${gerenciador} .formulario`);
            forms.forEach((form) => {
                form.style.display = "none";
            });
            gerenciado.style.display = "none";
            document.querySelector(`.${classe}`).style.display = "flex";
        }

        var c = 0;
        function menuPerfil() {
            const div = document.querySelector('.menuPerfil');
            if (c === 1) {
                div.style.display = 'none';
                c=0;
            } else {
                div.style.display = 'flex';
                c++;
            }
            
        }

        function mostrarMais() {
            const moreMais = document.querySelector('.moreMais');
            const moreMenos = document.querySelector('.moreMenos');
            const menu = document.querySelector('.menu-lateral');
            moreMais.style.display = "none";
            moreMenos.style.display = "flex";
            menu.style.width = "300px";
            const lis = document.querySelectorAll('.menu-lateral ul li div');
            lis.forEach((li) => {
                li.style.display = "flex";
                li.style.margin = "0px auto 0px 0px";
                li.style.padding = "0px 20px 0px 0px";
            });
        }

        function mostrarMenos() {
            const moreMais = document.querySelector('.moreMais');
            const moreMenos = document.querySelector('.moreMenos');
            const menu = document.querySelector('.menu-lateral');
            moreMais.style.display = "flex";
            moreMenos.style.display = "none";
            menu.style.width = "auto";
            const lis = document.querySelectorAll('.menu-lateral ul li div');
            lis.forEach((li) => {
                li.style.display = "none";
                li.style.margin = "0px auto";
                li.style.padding = "0px";
            });
        }



        async function sairDaConta() {
            await localStorage.clear();
            await window.location.reload();
        }

        // PAGINAS
        function home() {
            window.location.href = "./index.html";
        }

        function formularios() {
            window.location.href = "./formularios.html";
        }

        function estatisticas() {
            window.location.href = "./estatisticas.html";
        }

       
       </script>


       <!-- LINKS DO BANCO DE DADOS -->
       <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
       <script src="https://www.gstatic.com/firebasejs/10.3.0/firebase-app-compat.js"></script>
       <script src="https://www.gstatic.com/firebasejs/10.3.0/firebase-firestore-compat.js"></script>
       <script src="https://www.gstatic.com/firebasejs/10.3.0/firebase-storage-compat.js"></script>

       <!------------------------------------->
       <!-- BANCO DE DADOS GERAL (FIREBASE) -->
       <!------------------------------------->

       <script>

          // BANCO DE DADOS DO APLICATIVO EM GERAL
          const firebaseConfig1 = {
            apiKey: "AIzaSyC6aMNEjsgeGK-rw4hzLUximzh1YQ6OEII",
            authDomain: "banco-de-dados-32cac.firebaseapp.com",
            projectId: "banco-de-dados-32cac",
            storageBucket: "banco-de-dados-32cac.appspot.com",
            messagingSenderId: "1001209948956",
            appId: "1:1001209948956:web:e28198053d747377aee8d9"
          };

          firebase.initializeApp(firebaseConfig1);
          const db1 = firebase.firestore();
          const storage1 = firebase.storage();

          // Pegar o ANO LETICO ATUAL
          const dataAtual = new Date();
          const anoAtual = dataAtual.getFullYear();
          localStorage.setItem('ano', anoAtual);
          const ANO = localStorage.getItem('ano');

          const logado = localStorage.getItem('logado');
            const usuario = localStorage.getItem('usuario');
            const senha = localStorage.getItem('senha');
            const perfis = document.querySelectorAll('.nome');
            perfis.forEach((perfil) => {
                if (logado === 'SERVIDOR') {
                    db1.collection(ANO)
                    .doc('restrito')
                    .collection('direcao')
                    .doc('login').get().then((doc) => {
                        if (doc.data().usuario === usuario) {
                            if (doc.data().senha === senha) {
                                perfil.innerHTML = `Olá, ${usuario}`;
                                return;
                            }
                        }
                    });

                    db1.collection(ANO)
                    .doc('restrito')
                    .collection('coordenacao')
                    .doc('login').get().then((doc) => {
                        if (doc.data().usuario === usuario) {
                            if (doc.data().senha === senha) {
                                perfil.innerHTML = `Olá, ${usuario}`;
                                return;
                            }
                        }
                    });
                    
                } else {
                    localStorage.clear();
                    window.location.reload();
                }
            });

            if (!logado) {
                window.location.href = '../index.html';
            }


            function addSerie() {
                const div = document.querySelector('.series');
                const serie = document.querySelector('.addSerie input[id="serie"]').value;
                document.body.style.cursor = "wait";
                db1.collection(ANO)
                .doc('restrito')
                .collection('series')
                .doc(serie).set({})
                .then((response) => {
                    document.body.style.cursor = "default";
                    swal({
                        title: 'Parabens',
                        text: 'Serie adicionada com sucesso!',
                        buttons: {
                            confirm: 'Ok',
                        },
                    }).then((res) => {
                        window.location.reload();
                    });
                })
            }

            function addForm() {
                const nome = document.getElementById('nomeForm').value;
                const icon = document.getElementById('iconForm').value;
                const formulario = document.getElementById('formularioForm').value;
                const planilha = document.getElementById('planilhaForm').value;
                const usuario = logado.toLowerCase();
                if (nome && icon && formulario && planilha) {
                    document.body.style.cursor = "wait";
                    db1.collection('controle')
                    .doc(usuario)
                    .collection('formularios')
                    .doc(nome).set({
                        estatistica: planilha,
                        url: formulario,
                        icon: icon,
                    })
                    .then((response) => {
                        document.body.style.cursor = "default";
                        swal({
                            title: 'Parabens',
                            text: 'Formulário adicionado com sucesso!',
                            buttons: {
                                confirm: 'Ok',
                            },
                        }).then((res) => {
                            window.location.reload();
                        });
                    })    
                } 
                
            }

            function fecharSeries() {
                const div = document.querySelector('.series');
                div.style.display = "none";
            }

            function fecharForm() {
                const div = document.querySelector('.form');
                div.style.display = "none";
            }

            function fecharUsuario(usuario) {
                const div = document.querySelector(`.usuarios${usuario}`);
                div.style.display = "none";
            }

            function lerSeries() {
                const div = document.querySelector('.series');
                db1.collection(ANO)
                .doc('restrito')
                .collection('series')
                .onSnapshot((data) => {
                    div.innerHTML = `
                        <h1 style="margin: 5px 0px; font-size: 20px;">Series Existentes</h1>
                        <button onclick="fecharSeries(), abrirForm('addSerie', 'banco-de-dados')">Adicionar Serie</button>
                    `;
                    data.docs.map((val, index) => {
                        const serie = val.id;
                        div.innerHTML += `
                            <li>
                                <h1>${serie}</h1>
                                <ion-icon onclick="excluirSerie('${serie}')" name="trash"></ion-icon>
                            </li>
                        `;
                    });
                });
            }

            function lerForm() {
                const usuario = logado.toLowerCase();
                const div = document.querySelector('.form');
                db1.collection('controle')
                .doc(usuario)
                .collection('formularios')
                .onSnapshot((data) => {
                    div.innerHTML = `
                        <h1 style="margin: 5px 0px; font-size: 20px;">Formulários Existentes</h1>
                        <button onclick="fecharForm(), abrirForm('addForm', 'banco-de-dados')">Adicionar Formulario</button>
                    `;
                    data.docs.map((val, index) => {
                        const formulario = val.id;
                        const icon = val.data().icon;
		    	const professor = val.data().professor;
		    	const funcionario = val.data().funcionario;
			var linha = `<li>
			<div class="flex">
				<h1><ion-icon class="iconNormal" name="${icon}"></ion-icon>${formulario}</h1>
				<ion-icon onclick="excluirForm('${formulario}')" name="trash"></ion-icon>
			</div>`;
			if (professor) {
			  linha += `<button class="verde">Professor</button>`;	
			} else {
			  linha += `<button class="vermelho">Professor</button>`;
			}
			    
			if (funcionario) {
			  linha += `<button class="verde">Funcionario</button>`;	
			} else {
			  linha += `<button class="vermelho">Funcionario</button>`;
			}
                        div.innerHTML += `
                            ${linha}
			    </li>
                        `;
                    });
                });
            }

            // LER USUARIOS (Direcao, Coordenacao e professores)
            function lerUsuarios(usuario) {
                const div = document.querySelector(`.usuarios${usuario}`);
                div.style.flexDirection = "column";
                db1.collection(ANO)
                .doc('restrito')
                .collection(usuario)
                .doc('login')
                .collection('acessos')
                .onSnapshot((data) => {
                    div.innerHTML = `
                        <h1 style="margin: 5px 0px; font-size: 20px;">Usuarios Existentes</h1>
                        <button onclick="fecharUsuario('${usuario}'), abrirForm('add${usuario}', 'banco-de-dados')">Adicionar Usuario</button>
                    `;
                    data.docs.map((val, index) => {
                        const nome = val.id;
                        div.innerHTML += `
                            <li>
                                <h1>${nome}</h1>
                                <ion-icon onclick="excluirUsuario('${usuario}', '${nome}')" name="trash"></ion-icon>
                            </li>
                        `;
                    });
                });
            }

            function addUsuario(usuario) {
                const div = document.querySelector('.series');
                const usu = document.querySelector(`.add${usuario} input[id="${usuario}"]`).value;
                document.body.style.cursor = "wait";
                db1.collection(ANO)
                .doc('restrito')
                .collection(usuario)
                .doc('login')
                .collection('acessos')
                .doc(usu).set({})
                .then((response) => {
                    document.body.style.cursor = "default";
                    swal({
                        title: 'Parabens',
                        text: 'Usuario adicionado com sucesso!',
                        buttons: {
                            confirm: 'Ok',
                        },
                    }).then((res) => {
                        window.location.reload();
                    });
                })
            }

            function excluirSerie(serie) {
                swal({
                    title: 'Aviso',
                    text: `Você deseja excluir a serie ${serie}`,
                    buttons: {
                        confirm: 'Sim',
                        cancel: 'Não',
                    },
                }).then((resposta) => {
                    if (resposta) {
                        document.body.style.cursor = "wait";
                        db1.collection(ANO)
                        .doc('restrito')
                        .collection('series')
                        .doc(serie).delete().then((resposne) => {
                            document.body.style.cursor = "default";
                            swal({
                                title: 'Parabens',
                                text: 'Serie excluida com sucesso!',
                                buttons: {
                                    confirm: 'Ok',
                                },
                            }).then((res) => {
                                window.location.reload();
                            });
                        });
                    }
                });
            }

            function excluirForm(formulario) {
                const usuario = logado.toLowerCase();
                swal({
                    title: 'Aviso',
                    text: `Você deseja excluir o Formulário '${formulario}'`,
                    buttons: {
                        confirm: 'Sim',
                        cancel: 'Não',
                    },
                }).then((resposta) => {
                    if (resposta) {
                        document.body.style.cursor = "wait";
                        db1.collection('controle')
                        .doc(usuario)
                        .collection('formularios')
                        .doc(formulario).delete().then((resposne) => {
                            document.body.style.cursor = "default";
                            swal({
                                title: 'Parabens',
                                text: 'Formulário excluido com sucesso!',
                                buttons: {
                                    confirm: 'Ok',
                                },
                            }).then((res) => {
                                window.location.reload();
                            });
                        });
                    }
                });
            }

            function excluirUsuario(usuario, nome) {
                swal({
                    title: 'Aviso',
                    text: `Você deseja excluir o usuario '${nome}'`,
                    buttons: {
                        confirm: 'Sim',
                        cancel: 'Não',
                    },
                }).then((resposta) => {
                    if (resposta) {
                        document.body.style.cursor = "wait";
                        db1.collection(ANO)
                        .doc('restrito')
                        .collection(usuario)
                        .doc('login')
                        .collection('acessos')
                        .doc(nome).delete().then((resposne) => {
                            document.body.style.cursor = "default";
                            swal({
                                title: 'Parabens',
                                text: `Usuario '${nome}' excluido com sucesso!`,
                                buttons: {
                                    confirm: 'Ok',
                                },
                            }).then((res) => {
                                window.location.reload();
                            });
                        });
                    }
                });
            }


            async function atualizarIcone() {
                const span = document.getElementById('mostrarIcone');
                const icone = document.getElementById('iconForm').value;
                span.innerHTML = `<ion-icon name="${icone}"></ion-icon>`;
            }

       </script>

        <script>
            const directoryUrl = 'https://unpkg.com/browse/ionicons@7.1.0/dist/ionicons/svg/';
            const ionIconsSelect = document.getElementById('iconForm');

            function extractSvgFileNames(html) {
                const regex = /href="([^"]+\.svg)"/g;
                const matches = [];
                let match;

                while ((match = regex.exec(html)) !== null) {
                    matches.push(match[1]);
                }

                return matches;
            }

            fetch(directoryUrl)
                .then(response => response.text())
                .then(html => {
                    const svgFileNames = extractSvgFileNames(html);

                    svgFileNames.forEach(svgFileName => {
                        // Remove a extensão .svg do nome do arquivo
                        const iconName = svgFileName.replace(/\.svg$/, '');

                        // Cria um novo elemento <option>
                        const optionElement = document.createElement('option');

                        // Usa emojis como alternativa para representar os ícones
                        optionElement.textContent = `🔵 ${iconName}`;

                        // Define o valor do <option> como o nome do ícone
                        optionElement.value = iconName;

                        // Adiciona o elemento <option> à lista de seleção
                        ionIconsSelect.appendChild(optionElement);
                    });
                })
                .catch(error => console.error('Erro ao obter lista de arquivos SVG:', error));
        </script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
       

</html>
